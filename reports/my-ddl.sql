SET FOREIGN_KEY_CHECKS=0;
DROP TABLE IF EXISTS Earnings;
DROP TABLE IF EXISTS Cash_Flow;
DROP TABLE IF EXISTS Balance_Sheet;
DROP TABLE IF EXISTS Income_Statement;
DROP TABLE IF EXISTS Stock;
DROP TABLE IF EXISTS Company;
SET FOREIGN_KEY_CHECKS=1;


BEGIN;
CREATE TABLE IF NOT EXISTS Company (
    Name VARCHAR(255),
    Sector VARCHAR(255),
    Industry VARCHAR(255),
    Ticker CHAR(5) PRIMARY KEY NOT NULL
);
COMMIT;


BEGIN;
INSERT INTO Company (Name, Sector, Industry, Ticker) VALUES
    ('Apple Inc.', 'Technology', 'Consumer Electronics', 'AAPL'),
    ('Microsoft Corporation', 'Technology', 'Software Infrastructure', 'MSFT'),
    ('Alphabet Inc.', 'Communication Services', 'Internet Content & Information', 'GOOGL'),
    ('Amazon.com Inc.', 'Consumer Cyclical', 'Internet Retail', 'AMZN'),
    ('Nvidia Corporation', 'Technology', 'Semiconductors', 'NVDA'),
    ('Tesla Inc.', 'Consumer Cyclical', 'Auto Manufacturers', 'TSLA'),
    ('Meta Platforms Inc.', 'Communication Services', 'Internet Content & Information', 'META');



BEGIN;
CREATE TABLE IF NOT EXISTS Stock (
    Stock_ticker CHAR(5) PRIMARY KEY,
    Eod_price DECIMAL(10,2),
    IPO_date DATE,
    FOREIGN KEY (Stock_ticker) 
        REFERENCES Company(Ticker)
        ON UPDATE CASCADE 
        ON DELETE CASCADE
);
COMMIT;


BEGIN;
INSERT INTO Stock (Stock_ticker, Eod_price, IPO_date) VALUES
    ('AAPL', 242.84, '1980-12-12'),
    ('MSFT', 443.57, '1986-03-13'),
    ('GOOGL', 174.71, '2004-08-19'),
    ('AMZN', 227.03, '1997-05-15'),
    ('NVDA', 142.44, '1999-01-22'),
    ('TSLA', 389.22, '2010-06-29'),
    ('META', 623.77, '2012-05-18');
COMMIT;


BEGIN;
CREATE TABLE IF NOT EXISTS Income_Statement (
    Statement_id INT PRIMARY KEY AUTO_INCREMENT,
    Stock_ticker CHAR(5),
    Fiscal_year_end DATE,
    Total_revenue DECIMAL(15,2),
    Cost_of_revenue DECIMAL(15,2),
    Gross_profit DECIMAL(15,2),
    Operating_income DECIMAL(15,2),
    Net_income_common_stockholders DECIMAL(15,2),
    Pretax_income DECIMAL(15,2),
    Ebit DECIMAL(15,2), 
    Ebitda DECIMAL(15,2),
    FOREIGN KEY (Stock_ticker) 
        REFERENCES Company(Ticker)
        ON UPDATE CASCADE 
        ON DELETE CASCADE
);
COMMIT;


BEGIN;
INSERT INTO Income_Statement (Stock_ticker, Fiscal_year_end, Total_revenue, Cost_of_revenue, Gross_profit, Operating_income, Net_income_common_stockholders, Pretax_income, Ebit, Ebitda) VALUES
    ('GOOGL', '2020-12-31', 182527000, 84732000, 97795000, 41224000, 40269000, 48082000, 48217000, 61914000),
    ('AMZN', '2020-12-31', 386064000, 334564000, 51500000, 22899000, 21331000, 24178000, 25825000, 51005000),
    ('TSLA', '2020-12-31', 31536000, 24906000, 6630000, 1994000, 690000, 1154000, 1902000, 4224000),
    ('META', '2020-12-31', 85965000, 16692000, 69273000, 32671000, 29146000, 33180000, 33180000, 39533000),
    ('AAPL', '2021-09-30', 365817000, 212981000, 152836000, 108949000, 94680000, 109207000, 111852000, 123136000),
    ('MSFT', '2021-06-30', 168088000, 52232000, 52232000, 69916000, 61271000, 71102000, 73448000, 85134000),
    ('GOOGL', '2021-12-31', 257637000, 110939000, 110939000, 78714000, 76033000, 90734000, 91080000, 103521000),
    ('AMZN', '2021-12-31', 469822000, 403507000, 66315000, 24879000, 33364000, 38151000, 39960000, 74393000),
    ('NVDA', '2021-01-31', 16675000, 6279000, 10396000, 4532000, 4332000, 4409000, 4593000, 5691000),
    ('TSLA', '2021-12-31', 53823000, 40217000, 13606000, 6496000, 5524000, 6343000, 6714000, 9625000),
    ('META', '2021-12-31', 117929000, 22649000, 95280000, 46753000, 39370000, 47284000, 47307000, 55274000),
    ('AAPL', '2022-09-30', 394328000, 223546000, 170782000, 119437000, 99803000, 119103000, 119437000, 130541000),
    ('MSFT', '2022-06-30', 198270000, 62650000, 135620000, 83383000, 72738000, 83716000, 85779000, 100239000),
    ('GOOGL', '2022-12-31', 282836000, 126203000, 156633000, 74842000, 59972000, 71328000, 71685000, 85160000),
    ('AMZN', '2022-12-31', 513983000, 446343000, 67640000, 12248000, -2722000, -5936000, -3569000, 38352000),
    ('NVDA', '2022-01-31', 26914000, 9439000, 17475000, 10041000, 9752000, 9941000, 10177000, 11351000),
    ('TSLA', '2022-12-31', 81462000, 60609000, 20853000, 13832000, 12583000, 13719000, 13910000, 17657000),
    ('META', '2022-12-31', 116609000, 25249000, 91360000, 28944000, 23200000, 28819000, 29004000, 37690000),
    ('AAPL', '2023-09-30', 383285000, 214137000, 169148000, 114301000, 96995000, 113736000, 114301000, 125820000),
    ('MSFT', '2023-06-30', 211915000, 65863000, 146052000, 88523000, 72361000, 89311000, 91279000, 105140000),
    ('GOOGL', '2023-12-31', 307394000, 133332000, 174062000, 84293000, 73795000, 85717000, 86025000, 97971000),
    ('AMZN', '2023-12-31', 574785000, 480980000, 93805000, 36852000, 30425000, 37557000, 40739000, 89402000),
    ('NVDA', '2023-01-31', 26974000, 11618000, 15356000, 5577000, 4368000, 4181000, 4443000, 5987000),
    ('TSLA', '2023-12-31', 96773000, 79113000, 17660000, 8891000, 14999000, 9973000, 10129000, 14796000),
    ('META', '2023-12-31', 134902000, 25959000, 108943000, 46751000, 39098000, 47428000, 47874000, 59052000),
    ('AAPL', '2024-09-30', 391035000, 210352000, 180683000, 123216000, 93736000, 123485000, 123216000, 134661000),
    ('MSFT', '2024-06-30', 245122000, 74114000, 171008000, 109433000, 88136000, 107787000, 110722000, 133009000),
    ('NVDA', '2024-01-31', 60922000, 16621000, 44301000, 32972000, 29760000, 33818000, 34075000, 35583000);
COMMIT;


BEGIN;
CREATE TABLE IF NOT EXISTS Balance_Sheet (
    Statement_id INT PRIMARY KEY AUTO_INCREMENT,
    Stock_ticker CHAR(5),
    Fiscal_year_end DATE NOT NULL,
    Total_assets DECIMAL(15,2) NOT NULL,
    Current_assets DECIMAL(15,2) NOT NULL,
    Cash_and_cash_equivalents DECIMAL(15,2) NOT NULL,
    Accounts_receivable DECIMAL(15,2) NOT NULL,
    Total_debt DECIMAL(15,2) NOT NULL,
    Long_term_debt DECIMAL(15,2),
    Net_tangible_assets DECIMAL(15,2) NOT NULL,
    Working_capital DECIMAL(15,2) NOT NULL,
    Invested_capital DECIMAL(15,2) NOT NULL,
    Tangible_book_value DECIMAL(15,2),
    Total_capitalization DECIMAL(15,2),
    Shares_issued INT,
    Stockholders_equity DECIMAL(15,2),
    Retained_earnings DECIMAL(15,2),
    Common_stock_equity DECIMAL(15,2),
    FOREIGN KEY (Stock_ticker) 
        REFERENCES Company(Ticker)
        ON UPDATE CASCADE 
        ON DELETE CASCADE
);
COMMIT;


BEGIN;
INSERT INTO Balance_Sheet (Stock_ticker, Fiscal_year_end, Total_assets, Current_assets, Cash_and_cash_equivalents, Accounts_receivable, Total_debt, Long_term_debt, Net_tangible_assets, Working_capital, Invested_capital, Tangible_book_value, Total_capitalization, Shares_issued, Stockholders_equity, Retained_earnings, Common_stock_equity) VALUES
    ('GOOGL', '2020-12-31', 319616000, 174296000, 26465000, 30930000, 26772000, 12832000, 199924000, 117462000, 235376000, 199924000, 235376000, 13504440, 222544000, 163401000, 222544000),
    ('AMZN', '2020-12-31', 321195000, 132733000, 42122000, 24542000, 84389000, 31816000, 73406000, 6348000, 125220000, 73406000, 125220000, 10540000, 93404000, 52551000, 93404000),
    ('TSLA', '2020-12-31', 52148000, 26717000, 19384000, 1886000, 13279000, 8513000, 21705000, 12469000, 32496000, 21705000, 30738000, 2880000, 22225000, -5399000, 22225000),
    ('META', '2020-12-31', 159316000, 75670000, 17576000, 11335000, 10654000, NULL, 108617000, 60689000, 128290000, 108617000, 128290000, 2849000, 128290000, 77345000, 128290000),
    ('AAPL', '2021-09-30', 351002000, 134836000, 34940000, 26278000, 136522000, 109106000, 63090000, 9355000, 187809000, 63090000, 172196000, 16426786, 63090000, 5562000, 63090000),
    ('MSFT', '2021-06-30', 333779000, 184406000, 14224000, 38043000, 67775000, 50074000, 84477000, 95749000, 200134000, 84477000, 192062000, 7519000, 141988000, 57055000, 141988000),
    ('GOOGL', '2021-12-31', 359268000, 188143000, 20945000, 39304000, 28395000, 12844000, 227262000, 123889000, 264479000, 227262000, 264479000, 13242420, 251635000, 191484000, 251635000),
    ('AMZN', '2021-12-31', 420549000, 161580000, 36220000, 32891000, 116395000, 48744000, 117767000, 19314000, 186989000, 117767000, 186989000, 10640000, 138245000, 85915000, 138245000),
    ('NVDA', '2021-01-31', 28791000, 16055000, 847000, 2429000, 7597000, 5964000, 9963000, 12130000, 23856000, 9963000, 22857000, 38600000, 16893000, 18908000, 16893000),
    ('TSLA', '2021-12-31', 62131000, 27100000, 17576000, 1913000, 8873000, 4254000, 28472000, 7395000, 35531000, 28472000, 34443000, 3099000, 30189000, 329000, 30189000),
    ('META', '2021-12-31', 165987000, 66666000, 16601000, 14039000, 13873000, NULL, 105048000, 45531000, 124879000, 105048000, 124879000, 2741000, 124879000, 69761000, 124879000),
    ('AAPL', '2022-09-30', 352755000, 135405000, 23646000, 28184000, 132480000, 98959000, 50672000, -18577000, 170741000, 50672000, 149631000, 15943425, 50672000, -3068000, 50672000),
    ('MSFT', '2022-06-30', 364840000, 169684000, 13931000, 44261000, 61270000, 47032000, 87720000, 74602000, 216323000, 87720000, 213574000, 7464000, 166542000, 84281000, 166542000),
    ('GOOGL', '2022-12-31', 365264000, 164795000, 21879000, 40258000, 29679000, 12857000, 227184000, 95495000, 269001000, 227184000, 269001000, 12849000, 256144000, 195563000, 256144000),
    ('AMZN', '2022-12-31', 462675000, 146791000, 53888000, 42360000, 140118000, 67150000, 119658000, -8602000, 213193000, 119658000, 213193000, 10757000, 146043000, 83193000, 146043000),
    ('NVDA', '2022-01-31', 44187000, 28829000, 1990000, 4650000, 11831000, 10946000, 19924000, 24494000, 37558000, 19924000, 37558000, 25060000, 26612000, 16235000, 26612000),
    ('TSLA', '2022-12-31', 82338000, 40917000, 16253000, 2952000, 5748000, 1029000, 44111000, 14208000, 46749000, 44111000, 45733000, 3164000, 44704000, 12885000, 44704000),
    ('META', '2022-12-31', 185727000, 59549000, 14681000, 13466000, 26591000, 9923000, 104510000, 32523000, 135636000, 104510000, 135636000, 2614000, 125713000, 64799000, 125713000),
    ('AAPL', '2023-09-30', 352583000, 143566000, 29965000, 29508000, 111088000, 95281000, 62146000, -1742000, 173234000, 62146000, 157427000, 15550061, 62146000, -214000, 62146000),
    ('MSFT', '2023-06-30', 411976000, 184257000, 34704000, 48688000, 59965000, 41990000, 128971000, 80108000, 253460000, 128971000, 248213000, 7432000, 206223000, 118848000, 206223000),
    ('GOOGL', '2023-12-31', 402392000, 171530000, 24048000, 47964000, 28504000, 11870000, 254181000, 89716000, 295249000, 254181000, 295249000, 12460000, 283379000, 211247000, 283379000),
    ('AMZN', '2023-12-31', 527854000, 172351000, 73387000, 52253000, 135611000, 58314000, 171399000, 7434000, 260189000, 171399000, 260189000, 10898000, 201875000, 113618000, 201875000),
    ('NVDA', '2023-01-31', 41182000, 23073000, 3389000, 3827000, 12031000, 9703000, 16053000, 16510000, 33054000, 16053000, 31804000, 24661365, 22101000, 10171000, 22101000),
    ('TSLA', '2023-12-31', 106618000, 49616000, 16398000, 3508000, 9573000, 2682000, 62019000, 20868000, 67291000, 62019000, 65316000, 3185000, 62634000, 27882000, 62634000),
    ('META', '2023-12-31', 229623000, 85365000, 41862000, 16169000, 37234000, 18385000, 131726000, 53405000, 171553000, 131726000, 171553000, 2561000, 153168000, 82070000, 153168000),
    ('AAPL', '2024-09-30', 364980000, 152987000, 29943000, 33410000, 106629000, 85750000, 56950000, -23405000, 163579000, 56950000, 142700000, 15116786, 56950000, -19154000, 56950000),
    ('MSFT', '2024-06-30', 512163000, 159734000, 18315000, 56924000, 67127000, 42688000, 121660000, 34448000, 320107000, 121660000, 311165000, 7434000, 268477000, 173144000, 268477000),
    ('NVDA', '2024-01-31', 65728000, 44345000, 7280000, 9999000, 11056000, 8459000, 37436000, 33714000, 52687000, 37436000, 51437000, 24640000, 42978000, 29817000, 42978000);
COMMIT;


BEGIN;
CREATE TABLE IF NOT EXISTS Cash_Flow (
    Statement_id INT PRIMARY KEY AUTO_INCREMENT,
    Stock_ticker CHAR(5),
    Fiscal_year_end DATE NOT NULL,
    Operating_cashflow DECIMAL(15,2) NOT NULL,
    Capital_expenditures DECIMAL(15,2),
    Free_cash_flow DECIMAL(15,2),
    Cash_dividends_paid DECIMAL(15,2),
    FOREIGN KEY (Stock_ticker) 
        REFERENCES Company(Ticker)
        ON UPDATE CASCADE 
        ON DELETE CASCADE
);
COMMIT;


BEGIN;
INSERT INTO Cash_Flow (Stock_ticker, Fiscal_year_end, Operating_cashflow, Capital_expenditures, Free_cash_flow, Cash_dividends_paid) VALUES
    ('GOOGL', '2020-12-31', 65124000, -22281000, 42843000, NULL),
    ('AMZN', '2020-12-31', 66064000, -40140000, 25924000, NULL),
    ('TSLA', '2020-12-31', 5943000, -3242000, 2701000, NULL),
    ('META', '2020-12-31', 38747000, -15163000, 23584000, NULL),
    ('AAPL', '2021-09-30', 104038000, -11085000, 92953000, -14467000),
    ('MSFT', '2021-06-30', 76740000, -20622000, 56118000, -16521000),
    ('GOOGL', '2021-12-31', 91652000, -24640000, 67012000, NULL),
    ('AMZN', '2021-12-31', 46327000, -61053000, -14726000, NULL),
    ('NVDA', '2021-01-31', 5822000, -1128000, 4694000, -395000),
    ('TSLA', '2021-12-31', 11497000, -8014000, 3483000, NULL),
    ('META', '2021-12-31', 57683000, -18690000, 38993000, NULL),
    ('AAPL', '2022-09-30', 122151000, -10708000, 111443000, -14841000),
    ('MSFT', '2022-06-30', 89035000, -23886000, 65149000, -18135000),
    ('GOOGL', '2022-12-31', 91495000, -31485000, 60010000, NULL),
    ('AMZN', '2022-12-31', 46752000, -63645000, -16893000, NULL),
    ('NVDA', '2022-01-31', 9108000, -976000, 8132000, -399000),
    ('TSLA', '2022-12-31', 14724000, -7172000, 7552000, NULL),
    ('META', '2022-12-31', 50475000, -31431000, 19044000, NULL),
    ('AAPL', '2023-09-30', 110543000, -10959000, 99584000, -15025000),
    ('MSFT', '2023-06-30', 87582000, -28107000, 59475000, -19800000),
    ('GOOGL', '2023-12-31', 101746000, -32251000, 69495000, NULL),
    ('AMZN', '2023-12-31', 84946000, -52729000, 32217000, NULL),
    ('NVDA', '2023-01-31', 5641000, -1833000, 3808000, -398000),
    ('TSLA', '2023-12-31', 13256000, -8899000, 4357000, NULL),
    ('META', '2023-12-31', 71113000, -27266000, 43847000, NULL),
    ('AAPL', '2024-09-30', 118254000, -9447000, 108807000, -15234000),
    ('MSFT', '2024-06-30', 118548000, -44477000, 74071000, -21771000),
    ('NVDA', '2024-01-31', 28090000, -1069000, 27021000, -395000);    
COMMIT;


BEGIN;
CREATE TABLE IF NOT EXISTS Earnings (
    Earnings_id INT PRIMARY KEY AUTO_INCREMENT,
    Stock_ticker CHAR(5),
    Fiscal_date_end DATE NOT NULL,
    Reported_eps DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (Stock_ticker)
        REFERENCES Company(Ticker)
        ON UPDATE CASCADE 
        ON DELETE CASCADE
);
COMMIT;

BEGIN;
INSERT INTO Earnings (Stock_ticker, Fiscal_date_end, Reported_eps) VALUES
    ('AAPL', '2021-09-30', 5.62),
    ('MSFT', '2021-06-30', 7.97),
    ('GOOGL', '2021-12-31', 5.6),
    ('AMZN', '2021-12-31', 2.15),
    ('NVDA', '2021-01-31', 0.2505),
    ('TSLA', '2021-12-31', 2.26),
    ('META', '2021-12-31', 13.8),
    ('AAPL', '2022-09-30', 6.11),
    ('MSFT', '2022-06-30', 9.2),
    ('GOOGL', '2022-12-31', 4.55),
    ('AMZN', '2022-12-31', 0.97),
    ('NVDA', '2022-01-31', 0.4445),
    ('TSLA', '2022-12-31', 4.07),
    ('META', '2022-12-31', 8.58),
    ('AAPL', '2023-09-30', 6.12),
    ('MSFT', '2023-06-30', 9.81),
    ('GOOGL', '2023-12-31', 5.8),
    ('AMZN', '2023-12-31', 2.9),
    ('NVDA', '2023-01-31', 0.333),
    ('TSLA', '2023-12-31', 3.13),
    ('META', '2023-12-31', 14.9),
    ('AAPL', '2024-09-30', 6.75),
    ('MSFT', '2024-06-30', 11.81),
    ('GOOGL', '2024-09-30', 5.9),
    ('AMZN', '2024-09-30', 3.67),
    ('NVDA', '2024-01-31', 1.297),
    ('TSLA', '2024-09-30', 1.69),
    ('META', '2024-09-30', 15.9);
COMMIT;